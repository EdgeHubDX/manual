---
layout: default
grand_parent: Pages
parent: 보고서
title: 레이아웃 정의
nav_order: 3
---

{: .no_toc }
# 레이아웃 정의  
어떤 태그를 언제 출력할 것인가? 가 정의되면 다음 단계는 **어떤 형태로 출력**할 것인가를 정의합니다. **일반보고서**에서는 **자체 양식 편집기**를 통해 보고서 레이아웃을 편집합니다. **엑셀보고서**에서는 속성에서 서식파일로 정의된 **엑셀 파일을 기반으로 보고서 레이아웃**을 편집합니다.

- TOC
{:toc}

## 태그 로깅 보고서 레이아웃  
보고서 속성에서 보고서 유형으로 `일반 보고서`를 선택하고, 보고서 종류로 `태그 로깅 보고서`를 선택하면 **태그 로깅 보고서 레이아웃**을 정의할 수 있습니다.  
`해당 보고서 아이콘`을 선택한 후 마우스의 우측 버튼을 누른후, 표시되는 팝업 메뉴에서 `[보고서 레이아웃]` 메뉴를 클릭하면 아래와 같은 화면이 표시되고 보고서 **레이아웃을 편집**할 수 있습니다

![LAYOUT]({{ site.url }}/docs/pages/report/layout/layout-1.png)

### 편집기 화면   
1. **레이아웃 편집 툴바**  
    보고서 레이아웃 편집시 사용할 수 있는 **텍스트 서식, 정렬, 레이아웃 확대/축소, 컨트롤 정렬, 컨트롤 크기/간격 맞춤 기능**을 제공합니다.  

2. **툴박스**  
    레이아웃 편집시 사용할 수 있는 **라인, 사각형, 글상자 기능**을 제공합니다.  

3. **디자인뷰**  
    레이아웃이 **실제로 편집되는 화면**이며 **툴바** 및 **툴박스**를 통해 다양한 **보고서 레이아웃 편집**이 이루어집니다. **디자인뷰**는 **미리보기 전환**이 가능하여 보고서를 출력 전에 미리보기 할 수 있습니다.
    디자인뷰 화면 `하단의 미리보기`를 누르면 아래와 같은 화면이 표시되어 보고서 출력전에 미리보기가 가능합니다. 미리보기의 **데이터는 임의로 작성**됩니다.  

    ![DESIGN_VIEW]({{ site.url }}/docs/pages/report/layout/designview-1.png)

4. **속성창**  
    레이아웃 편집에 사용하는 **테이블, 라인, 사각형, 글상자의 속성**을 설정할 수 있습니다.  

### 테이블 속성  
`레이아웃 편집 툴바`에서 연속데이터 `설정 툴`(![SETTING_TOOL]({{ site.url }}/docs/pages/report/layout/settingtool-2.png))을 누르면 아래와 같은 화면이 표시되고 태그 로깅 보고서 테이블 속성을 설정할 수 있습니다. **연속 데이터**와 **헤더/푸터 설정**으로 구성되어 있습니다.

1. **연속 데이터 설정**  
    연속 데이터 설정은 연속 데이터로 표시할 태그 리스트를 설정합니다.  

    ![CONTINUEDATA_SETTING]({{ site.url }}/docs/pages/report/layout/continuedatasetting-2.png)

    | 번호     | 속성 |설명 |
    |----------|----|----|
    |1|수집모델|DataWorX Historian에 정의된 **수집모델 정보**가 표시됩니다.|
    |2|태그 리스트| 해당 수집모델에 속해 있는 **태그 리스트**와 **연산종류**가 표시됩니다.|
    |3|기본표시형식| 보고서에 사용할 태그 중에 **날짜**와 **숫자 타입**일 경우, 해당 타입의 **기본 포맷을 설정**할 수 있습니다. 좌측 하단의 태그 리스트중에 보고서에 사용할 태그를 선택해 **연속 데이터**에 추가할 때 **날짜**와 **숫자 타입의 태그**는 표시형식의 기본 포맷으로 설정됩니다.|
    |4|연속 데이터| **일보, 월보, 년보** 등과 같이 복수의 태그들이 **일정한 시간 간격**으로 반복되는 형태를 갖는 보고서로서 동일한 특성을 가지므로 연속 데이터에 보고서 태그들을 등록하여 사용합니다.|
    |5|확인| 수집모델에서 선택한 보고서 태그를 이용해 태그 로깅 테이블이 작성되어 레이아웃에 표시됩니다. 추가된 **연속 데이터** 및 **헤더/푸터 설정**, **개별태그 설정 정보**가 저장됩니다.|
    |6|취소| 변경된 내용을 저장하지 않고 연속데이터 설정 화면을 종료합니다.|

    좌측상단의 `수집모델`을 선택하면, 아래의 리스트에 해당 수집모델에 속해 있는 **태그 리스트**와 **연산 종류**가 표시됩니다.  
    태그 중 해당 보고서에 설정하려고 하는 **태그를 선택 후** 
    - `개별추가`( ![ADD_ICON]({{ site.url }}/docs/pages/report/layout/addicon-2.png) ) 버튼을 누르면 연속 데이터 리스트에 추가합니다.  
    - `개별 삭제`( ![DELETE_ICON]({{ site.url }}/docs/pages/report/layout/deleteicon-2.png) ) 버튼을 눌러 태그를 리스트에서 삭제합니다.  
    - `전체 추가`(`>>`) 및 `전체 삭제`(`<<`)는 보고서 태그에 전체를 추가하거나 삭제합니다.  
    - `태그 추가`( ![TAGADD_ICON]({{ site.url }}/docs/pages/report/layout/tagaddicon-2.png) ) 버튼을 누르면 태그가 추가되어 테이블에 컬럼을 추가합니다.  
    - `태그 순서 변경`( ![TAGODER_ICON]({{ site.url }}/docs/pages/report/layout/tagordericon-2.png) ) 버튼을 누르면 선택된 한 개의 태그가 위/아래로 이동하여 테이블에 나타나는 태그 순서를 변경합니다.  

    ![CONTINUEDATA_SETTING_VIEW]({{ site.url }}/docs/pages/report/layout/continuedatasettingview-2.png)

2. **헤더/푸터 설정**  
    헤더/푸터 설정은 연속 데이터 편집시 설정한 **태그의 이름, 설명, 단위 속성** 선택하여 보고서 생성시 자동으로 테이블에 표시합니다. **최대값, 최소값, 평균값, 합계값의 통계값** 선택시 보고서 생성시 태그에 대한 **통계치**를 테이블에 자동으로 표시합니다.  

    ![HEADER_SETTING]({{ site.url }}/docs/pages/report/layout/headersetting-2.png)

    | 번호     | 속성 |설명 |
    |----------|----|----|
    |1|전체항목|테이블에 표시할 **태그의 속성** 및 **통계 항목**이 표시됩니다. **태그속성**과 **통계 및 개별태그**로 구성됩니다|
    |2|기본표시형식|보고서에 사용할 태그 속성이나 통계 항목에 **날짜**와 **숫자 타입**일 경우, 해당 타입의 기본포맷을 설정할 수 있습니다. 좌측의 항목중에 보고서에 사용할 **헤더/푸터 항목**을 선택해 선택항목에 추가할 때 **날짜와 숫자 타입**의 항목은 표시형식의 기본포맷으로 설정됩니다.|
    |3|헤더/푸터|테이블에 표시할 **태그 속성** 및 **통계 항목**을 테이블 상단에 표시하기 위해 헤더 항목에 추가할 수 있습니다. 테이블 하단에 표시하기 위해 푸터 항목에 추가할 수 있습니다.|
    |4|개별태그|테이블에 **개별태그** 및 **태그속성**을 표시하기 위해 [로깅태그 추가] 버튼이나 [태그속성 추가] 버튼을 누르면 개별 태그 항목에 추가되며 테이블에 표시됩니다.|
    
    - `항목 순서 변경`( ![COLUMN_ORDER_ICON]({{ site.url }}/docs/pages/report/layout/ordericon-2.png) ) 버튼을 누르면 선택된 한 개의 항목이 위/아래로 이동하여 테이블에 나타나는 헤더/푸터 항목 순서를 변경합니다.
    - `개별추가`( ![ADD_ICON]({{ site.url }}/docs/pages/report/layout/addicon-2.png) ) 버튼을 누르면 전체 항목에서 선택한 항목을 선택 항목에 추가합니다.  
    - `개별삭제`( ![DELETE_ICON]({{ site.url }}/docs/pages/report/layout/deleteicon-2.png))를 눌러, 선택항목에서 제거할 수 있습니다.  

    개별태그 설정은 **전체 항목**의 `통계 및 개별태그 탭`의 항목에서 `Custom 항목`을 선택해 추가하면 개별태그에 추가할 수 있습니다. 
    Custom 항목을 헤더/푸터에 추가한 후, 추가된 Custom 항목을 선택하면 개별 태그 화면이 활성화되면서 `[로깅태그 추가]` 및 `[태그속성 추가]` 버튼을 클릭하여 개별 태그를 설정할 수 있습니다. 

    - 빈 `태그 추가`( ![ADD_ICON]({{ site.url }}/docs/pages/report/layout/addicon-2.png)) 버튼을 클릭하여 빈 태그를 추가할 수 있으며, 추가된 컬럼은 공백으로 표시됩니다. 
    - `태그 삭제`( ![DELETE_ICON]({{ site.url }}/docs/pages/report/layout/deleteicon-2.png)) 버튼을 클릭하면 선택된 개별 태그를 삭제할 수 있습니다. 
    - `항목 순서 변경`( ![COLUMN_ORDER_ICON]({{ site.url }}/docs/pages/report/layout/ordericon-2.png) ) 버튼을 누르면 선택된 한 개의 항목이 위/아래로 이동하여 테이블에 나타나는 `개별 태그의 순서`를 변경합니다.

    ![HEADER_SETTING_DETAIL]({{ site.url }}/docs/pages/report/layout/headersettingdetail-2.png)

    `로깅태그 추가 버튼`을 클릭하면 수집모델/로깅태그 화면이 나타나며 수집모델에 속한 로깅 태그를 선택하여 확인 버튼을 누르면 개별태그 리스트에 로깅태그를 추가할 수 있습니다.

    ![LOGGIN_TAG_ADD]({{ site.url }}/docs/pages/report/layout/loggintagadd-2.png)

    **개별태그 리스트**에 추가된 `로깅태그의 요구시간 행`을 클릭하면 다음과 같은 화면이 표시되어 **요구시간을 설정**할 수 있습니다.

    ![REQUIRE_TIME]({{ site.url }}/docs/pages/report/layout/requiretime-2.png)

    {: .note }
    **셀 태그 요구시간 화면**은 개별 데이터 설정을 **보고서의 작성시간을 기준**으로 **과거 언제의 데이터**를 가져올지를 나타내는 방식으로써 **N*수집주기**의 시간만큼의 **과거 데이터**를 읽어오게 됩니다.  
    **수집시간**에 “0”을 입력하면 보고서 작성기준시간의 데이터를 조회하여 출력됩니다.  
    즉, **“00시00분00초”가 보고서 출력 기준시간**이라고 하면, **해당 셀의 데이터는 00시00분00초**가 됩니다.  
    **“12”**의 경우에는 보고서 출력시간 “00시00분00초”보다 **12분 이전의 데이터를 조회**하여 출력됩니다.   

    기타 설정은 규칙적인 문자열이 입력되며, 숫자를 제외한 키워드는 영문으로 하기의 키워드를 사용합니다.  

    | 키워드     | 설명 |
    |----------|----|
    | MM | 달|
    |DD | 일|
    |HH | 시|
    |MI | 분|

    숫자의 경우 `+`이면 **절대시간**을, `-`는 **상대시간**으로 해석합니다.  
    숫자는 **0을 허용하지 않으며**, 키워드를 사이로 해서 중간에 들어가는 숫자에는 **음수**를 넣을 수 없습니다.  
    하기의 범위로 입력 가능합니다.  

    | 키워드     | 범위 |
    |----------|----|
    |월| 1월~12월 |
    |일| 1일~31일 |
    |시| 0시~23시 |
    |분| 0분~59분 |
    
    규칙은 아래와 같으며, 기준시간은 2024/04/01 10:20:00으로 가정합니다.  

    | 기타 내용     | 해석 방법 |
    |----------|----|
    |-1MM25DD|2024/03/25 10:20:00을 의미합니다. -1MM은 상대시간으로 1달을 기준시간에서 빼고, 25DD는 절대시간으로 25일을 의미합니다.|
    |-1MM-25DD|	중간에 -25가 들어가면 안됩니다.|
    |-1MM0DD|	숫자로 0은 안됩니다.|
    |-1MM25DD30MI|	2024/03/25 10:30:00을 의미합니다.|
    |-2MM40MI|		2024/02/01 10:40:00을 의미합니다.|

    {: .note }
    **개별태그**에 **로깅태그를 추가**시, 요구시간을 설정하지 않고 확인 버튼을 누르면 요구시간을 설정하라는 메시지가 아래와 같이 나타납니다.  
    ![WARNING_REQUIRE]({{ site.url }}/docs/pages/report/layout/warningrequire-2.png)

    **개별태그**는 이력태그 뿐만 아니라 **태그이름, 태그설명, 태그단위 등과 같은 태그 속성**을 추가할 수 있습니다.  
    개별태그에서 `태그속성 추가 버튼`을 누르면 다음과 같은 화면이 표시됩니다.

    ![TAG_EDITOR]({{ site.url }}/docs/pages/report/layout/tageditor-2.png)

    태그를 선택하고, 필드명을 선택후 확인 버튼을 누르면 개별태그 리스트에 `태그명:필드명` 형태로 태그 속성이 추가됩니다.  
    필드명을 선택하지 않으면 기본으로 **tagValue 필드**가 **자동으로 지정**되어 저장됩니다.

3. **개별 데이터 관리**  
    연속 데이터와는 달리, 보고서 태그가 테이블이 아닌 **보고서의 특정 위치에 표시되기를 원하는 경우**에 사용됩니다. 해당 태그는 개별태그에 해당되며 이력태그 뿐만 아니라 **태그이름, 태그설명, 태그단위 등과 같은 태그 속성**을 추가할 수 있습니다. 해당 데이터는 테이블 형태가 아니라 **글상자 형태**로 태그 하나하나가 **글상자 하나에 매핑**되어 디자인뷰에 나타납니다. 레이아웃 편집 툴바에서 개별 데이터 관리 툴( ![DATA_MANAGE_ICON]({{ site.url }}/docs/pages/report/layout/datamanageicon-3.png) )을 누르면 아래와 같은 개별 데이터 관리 화면이 나타납니다.

    ![INDIVIDUAL_TAG_MANAGE]({{ site.url }}/docs/pages/report/layout/invtagmanage-3.png)

    | 번호     | 속성 |설명 |
    |----------|----|----|
    |1|수집모델|DataWorX Historian에 정의된 **수집모델 정보**가 표시됩니다.|
    |2|태그 리스트| 해당 수집모델에 속해 있는 **태그 리스트**와 **연산종류**가 표시됩니다.|
    |3|기본표시형식| 보고서에 사용할 태그 중에 **날짜**와 **숫자 타입**일 경우, 해당 타입의 기본포맷을 설정할 수 있습니다. 좌측 하단의 태그 리스트중에 보고서에 사용할 태그를 선택해 개별 데이터에 추가할 때 날짜와 숫자 타입의 태그는 표시형식의 기본포맷으로 설정됩니다.|
    |4|태그 속성 추가 | **개별 데이터**는 이력 태그 뿐만 아니라 **태그 속성**을 추가할 수 있으며, 태그 속성 추가 버튼을 누르면 태그 선택 화면이 나타나서 태그 속성을 선택하면 태그 속성이 추가됩니다.|
    |5|개별 데이터|개별 태그에 사용될 **이력 태그** 및 **태그 속성 정보**가 표시됩니다.|
    |6|레이아웃에 추가 | 개별 데이터 리스트에서 디자인뷰에 추가할 `개별 태그를 선택`하면 레이아웃에 `추가 버튼`이 활성화되며, 레이아웃에 `추가 버튼`을 누르면 선택된 개별 태그가 **글상자 형태**로 **디자인뷰에 추가**할 수 있습니다.|
    |7|확인| 선택한 개별 데이터가 저장됩니다.|
    |8|취소|변경된 내용을 저장하지 않고 개별 데이터 관리 화면을 종료합니다.|

    좌측의 보고서 태그 중, 해당 개별 데이터에 추가를 원하는 태그를 선택 후  
    개별추가( ![ADD_ICON]({{ site.url }}/docs/pages/report/layout/addicon-2.png)) 버튼을 누르면 개별 데이터 리스트에 추가합니다.(삭제 시는 개별삭제(![DELETE_ICON]({{ site.url }}/docs/pages/report/layout/deleteicon-2.png) ) 버튼을 누릅니다.)

    ![INDIVIDUAL_TAG_MANAGE_DETAIL]({{ site.url }}/docs/pages/report/layout/invtagmanagedetail-3.png)

    **요구시간 설정** 및 **태그 속성 추가**는 연속 데이터 설정에서 개별태그 설정 내용과 동일합니다.  
    디자인뷰에 추가할 개별태그를 선택하고 레이아웃에 추가 버튼을 누르면 레이아웃 화면에 개별태그를 추가할 수 있습니다. 개별데이터 관리 화면에서 수정된 개별데이터와 **일치하지 않는 디자인뷰의 개별태그 내용은 자동 삭제**됩니다.

4. **출력일 설정**  
    레이아웃 편집 툴바에서 출력일 설정 툴(![PRINTTIME_ICON]({{ site.url }}/docs/pages/report/layout/printtimeicon-2.png) )을 누르면 출력일을 표시하는 글상자가 디자인뷰에 생성됩니다. 글상자를 선택하여 마우스로 드래그하여 원하는 위치에 배치하면 보고서 생성시 출력일이 표시됩니다.  

5. **이력데이터 수집모델**  
    DataWorX Historian에 설정되어 있는 수집모델의 목록을 보고서 생성 주기와의 관계를 따져 색상으로 구분을 표시합니다.

    | 색상     | 설명 |
    |----------|----|
    |붉은색| **보고서 생성 주기와 일치하는 수집모델** 즉, 일보의 경우에는 1시간 수집주기의 데이터의 수집모델입니다.|
    |파란색| **일치하지는 않으나 보고서 생성이 가능**한 수집모델 즉, 일보의 경우에는 1시간보다 작고 정수배로 나누어 떨어지는 수집주기(1분, 10분, 30분 등)를 가진 수집모델입니다.|
    |흰색| 연속태그 데이터 영역에 적용이 **불가능한 수집모델을 표시**합니다.|

    `수집모델`을 선택하면 하단에는 거기에 속한 태그 리스트가 표시되며 **수집 모델의 성격**에 따라 선택할 수 있는 **데이터 종류**가 달라집니다.


    | 수집모델     | 아날로그 | 디지털 | 비고 |
    |----------|----|----|----|
    |정주기|	현재값|	현재상태|	최소수집 1초<BR/>빠른 시간주기(1분 이하)의 이력 트랜드에서 주로 사용|
    |통계|	현재값, 최소값, 최소시간, 최대값, 최대시간, 평균값, 합계값, 샘플링수|	On 횟수, 가동 시간, 변경 횟수|최소수집 1분<BR/>최소값, 최소시간, 최대값, 최대시간 연산주기 1분 보고서 또는 시간 단위이상 트랜드에서 주로 사용|
    |적산|	변경값, 샘플링 수|	지원 안함|	수집주기 : 1시간, 1일, 1월<BR/>태그 데이터가 적산 전력량, 유량계 등 계속 상승하는 특성을 가질 때 시간 단위의 데이터 변화량을 저장|

## 엑셀보고서 레이아웃  
보고서 속성에서 보고서 유형으로 `엑셀 보고서`를 선택하면, 보고서 종류로 **태그 로깅 보고서 레이아웃**을 정의할 수 있습니다. 해당 보고서 아이콘을 선택한 후 마우스의 우측 버튼을 누르고, 표시되는 팝업 메뉴에서 편집-보고서 레이아웃 메뉴를 클릭하면 아래와 같은 화면이 표시되고 보고서 레이아웃을 편집할 수 있습니다.

![EXCELREPORT_LAYOUT]({{ site.url }}/docs/pages/report/layout/excelreportlayout-4.png)

1. **시트 정보**  
    1. 보고서 속성에서 설정한 서식파일의 시트 기준으로 엑셀 레이아웃에 표시가 됩니다.  
    2. 생성날짜 셀 위치 : 엑셀 시트에 생성날짜를 적용하기 위해 설정 버튼( ![SETTING_ICON]({{ site.url }}/docs/pages/report/layout/settingicon-4.png) )을 통해 생성날짜를 적용합니다.  

    ![GEN_CELL_POS]({{ site.url }}/docs/pages/report/layout/getcellpos-4.png)

2. **연속데이터 설정**  
    연속데이터 설정을 위해 표시가 됩니다.  
    1. 연속데이터 설정 : 연속데이터의 태그를 편집 및 삭제를 하기 위해 사용됩니다.  
        - ![PLUS_ICON]({{ site.url }}/docs/pages/report/layout/plusicon-4.png) 버튼을 통해 연속데이터를 설정하며, ![MINUS_ICON]({{ site.url }}/docs/pages/report/layout/minus-icon-4.png)버튼을 통해 태그를 삭제합니다.  
        - `+`: 연속데이터 설정 창이 나타납니다.  
        - `-`:  연속데이터 설정에서 태그들을 삭제합니다.  
        - 삭제할 태그를 1개 이상 선택하여 (![MINUS_ICON]({{ site.url }}/docs/pages/report/layout/minus-icon-4.png)) 버튼을 통해 태그를 삭제할 수 있습니다.  

    2. 시간출력 시작 셀 위치 / 입력방향 : 시간출력 시작 셀 위치와 연속적인 입력방향을 적용하기 위해 설정 버튼( ![SETTING_ICON]({{ site.url }}/docs/pages/report/layout/settingicon-4.png) )을 통해 시간출력 시작 셀 위치 / 입력방향을 적용합니다.  
    3. 수집주기 : 최소 1개 이상의 태그가 등록되어야 수집주기가 표시됩니다.  

3. **연속데이터 리스트 창**  
    연속 데이터에 등록된 태그들을 표시합니다.  
    1. 연속 데이터에 등록된 태그목록들을 표시하며, 마우스 우측버튼을 통해 태그편집 및 태그삭제 기능도 제공됩니다.  

4. **개별데이터 설정**  
    개별데이터 설정을 위해 표시됩니다.  
    1. 개별데이터 설정 : 개별데이터의 태그를 편집 및 삭제를 하기위해 사용됩니다.  
        - ![PLUS_ICON]({{ site.url }}/docs/pages/report/layout/plusicon-4.png) 버튼을 통해 연속데이터를 설정하며, ![MINUS_ICON]({{ site.url }}/docs/pages/report/layout/minus-icon-4.png)버튼을 통해 태그를 삭제합니다.  
        - `+`: 개별데이터 설정 창이 나타납니다
        - `-`: 개별데이터 설정에서 태그들을 삭제합니다  
        - 삭제할 태그를 1개 이상 선택하여 (![MINUS_ICON]({{ site.url }}/docs/pages/report/layout/minus-icon-4.png)) 버튼을 통해 태그를 삭제할 수 있습니다.  
    2. 요구시간: 태그 편집 폼에서 등록된 태그의 요구시간을 설정합니다.  
        - 등록된 태그중에 요구시간을 추가 및 변경하려는 태그를 하나 선택하여 요구시간 버튼을 선택하여 변경합니다.
    3. 상태변경시각 : 개별데이터에 태그등록시 수집모드가 “이벤트”로 등록된 태그에 한해서만 설정이 가능합니다.
    
엑셀보고서 편집이 완료되어 런타임의 보고서 수동 및 자동출력을 통한 결과물은 다음과 같이 출력됩니다.  

엑셀 보고서 최종 결과물  
최종 보고서 편집기 레이아웃 설정은 다음과 같습니다.  

![LAYOUT_SET]({{ site.url }}/docs/pages/report/layout/layoutset-4.png)

설정된 레이아웃의 결과물은 다음과 같습니다.(연속데이터 결과화면)  

![LAYOUT_SET_FIN]({{ site.url }}/docs/pages/report/layout/layoutsetfin-4.png)

{: .note }
엑셀보고서에 사용하는 Form 파일의 속성에서 **개인정보 설정이 체크되어 있으면 엑셀보고서가 생성되지 않습니다**. 다음 이미지와 같이 체크해제하여 주시기 바랍니다.  
`[파일] → [옵션] → [보안센터] → [보안 센터 설정] → [개인 정보 옵션]`  
![SECURITY]({{ site.url }}/docs/pages/report/layout/security-4.png)